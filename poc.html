<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Concentrated Mixture Calculator</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
      /* Custom font for better aesthetics */
      body {
        font-family: "Inter", sans-serif;
      }
      /* Custom styles for rounded corners and shadows */
      .card {
        border-radius: 0.75rem; /* rounded-xl */
        box-shadow:
          0 10px 15px -3px rgba(0, 0, 0, 0.1),
          0 4px 6px -2px rgba(0, 0, 0, 0.05); /* shadow-xl */
      }
      input[type="number"]::-webkit-inner-spin-button,
      input[type="number"]::-webkit-outer-spin-button {
        -webkit-appearance: none;
        margin: 0;
      }
      input[type="number"] {
        -moz-appearance: textfield;
      }
    </style>
  </head>
  <body
    class="flex min-h-screen items-center justify-center bg-gradient-to-br from-blue-100 to-purple-200 p-4"
  >
    <div
      class="card mx-auto w-full max-w-md bg-white p-8 text-center md:p-10 lg:p-12"
    >
      <h1 class="mb-6 text-3xl font-extrabold text-gray-800 md:text-4xl">
        Mixture Calculator
      </h1>

      <p class="mb-8 text-sm text-gray-600 md:text-base">
        Enter your desired container size to calculate the required grams for
        each concentrate. The original formula is based on 120g Master Blend,
        60g Epsom Salt, and 120g Calcium Nitrate per 500ml of water.
      </p>

      <div class="mb-6">
        <label
          for="containerSize"
          class="mb-2 block text-left text-lg font-semibold text-gray-700"
          >Container Size:</label
        >
        <div class="flex items-center space-x-3">
          <input
            type="number"
            id="containerSize"
            min="0.1"
            step="0.1"
            value="500"
            class="flex-grow rounded-md border border-gray-300 p-3 text-lg text-gray-800 focus:ring-2 focus:ring-blue-400 focus:outline-none"
            placeholder="e.g., 500"
          />
          <select
            id="unit"
            class="rounded-md border border-gray-300 bg-white p-3 text-lg text-gray-800 focus:ring-2 focus:ring-blue-400 focus:outline-none"
          >
            <option value="ml">ml</option>
            <option value="gallon">Gallon</option>
            <option value="5gallon">5 Gallons</option>
          </select>
        </div>
      </div>

      <button
        onclick="calculateMixture()"
        class="focus:ring-opacity-75 w-full transform rounded-md bg-blue-600 px-6 py-3 font-bold text-white shadow-lg transition duration-300 ease-in-out hover:scale-105 hover:bg-blue-700 focus:ring-2 focus:ring-blue-400 focus:outline-none"
      >
        Calculate
      </button>

      <div
        id="results"
        class="mt-8 hidden rounded-xl border border-blue-200 bg-blue-50 p-6 text-left"
      >
        <h2 class="mb-4 text-2xl font-bold text-blue-800">Required Amounts:</h2>
        <p class="mb-2 text-lg text-gray-700">
          <span class="font-semibold">Master Blend:</span>
          <span id="masterBlendResult" class="font-bold text-blue-900"></span>
          grams
        </p>
        <p class="mb-2 text-lg text-gray-700">
          <span class="font-semibold">Epsom Salt:</span>
          <span id="epsomSaltResult" class="font-bold text-blue-900"></span>
          grams
        </p>
        <p class="text-lg text-gray-700">
          <span class="font-semibold">Calcium Nitrate:</span>
          <span
            id="calciumNitrateResult"
            class="font-bold text-blue-900"
          ></span>
          grams
        </p>
      </div>

      <div
        id="errorMessage"
        class="mt-4 hidden rounded-md border border-red-400 bg-red-100 p-3 text-red-700"
      >
        Please enter a valid container size (a positive number).
      </div>
    </div>

    <script>
      // Constants based on the original video's 500ml formula
      const ORIGINAL_VOLUME_ML = 500;
      const MASTER_BLEND_PER_500ML = 120; // grams
      const EPSOM_SALT_PER_500ML = 60; // grams
      const CALCIUM_NITRATE_PER_500ML = 120; // grams

      // Conversion factors to milliliters
      const GALLON_TO_ML = 3785.41; // 1 US liquid gallon = 3785.41 ml

      /**
       * Calculates the required grams of each component based on the user-entered container size and unit.
       */
      function calculateMixture() {
        const containerSizeInput = document.getElementById("containerSize");
        const unitSelect = document.getElementById("unit");
        const resultsDiv = document.getElementById("results");
        const errorMessageDiv = document.getElementById("errorMessage");

        const containerSize = parseFloat(containerSizeInput.value);
        const unit = unitSelect.value;

        // Input validation
        if (isNaN(containerSize) || containerSize <= 0) {
          errorMessageDiv.classList.remove("hidden");
          resultsDiv.classList.add("hidden"); // Hide results if there's an error
          return;
        } else {
          errorMessageDiv.classList.add("hidden"); // Hide error message if input is valid
        }

        let newVolumeML;

        // Convert the input container size to milliliters
        switch (unit) {
          case "ml":
            newVolumeML = containerSize;
            break;
          case "gallon":
            newVolumeML = containerSize * GALLON_TO_ML;
            break;
          case "5gallon":
            newVolumeML = containerSize * (5 * GALLON_TO_ML);
            break;
          default:
            // Should not happen with the given options, but good for robustness
            console.error("Unknown unit selected:", unit);
            newVolumeML = containerSize; // Default to ml if unit is unknown
        }

        // Calculate the scaling factor relative to the original 500ml formula
        const scalingFactor = newVolumeML / ORIGINAL_VOLUME_ML;

        // Calculate the new amounts for each component
        const newMasterBlend = (MASTER_BLEND_PER_500ML * scalingFactor).toFixed(
          2,
        );
        const newEpsomSalt = (EPSOM_SALT_PER_500ML * scalingFactor).toFixed(2);
        const newCalciumNitrate = (
          CALCIUM_NITRATE_PER_500ML * scalingFactor
        ).toFixed(2);

        // Display the results
        document.getElementById("masterBlendResult").textContent =
          newMasterBlend;
        document.getElementById("epsomSaltResult").textContent = newEpsomSalt;
        document.getElementById("calciumNitrateResult").textContent =
          newCalciumNitrate;

        // Show the results section
        resultsDiv.classList.remove("hidden");
      }

      // Optional: Trigger calculation on Enter key press in the input field
      document
        .getElementById("containerSize")
        .addEventListener("keypress", function (event) {
          if (event.key === "Enter") {
            calculateMixture();
          }
        });

      // Optional: Trigger calculation on unit change
      document
        .getElementById("unit")
        .addEventListener("change", calculateMixture);

      // Initial calculation on page load with default values
      document.addEventListener("DOMContentLoaded", calculateMixture);
    </script>
  </body>
</html>
